#!/usr/bin/python
import sys
import cgi
import json
from search import searchbuilder
from search import searchcache
def GET():
	print "Content-type:text/json\r\n\r\n"
	title = "in the end"
	category = "music"
	param = "size"
	buildcache = searchbuilder.Search(title,category)
	if param == "size":
		print json.dumps({"search_size:":searchcache.get_size_by_hash(buildcache._hash_title_and_category())})
	elif buildcache.check_in_cache():
		result = searchcache.open_search_by_hash(buildcache._hash_title_and_category())
		print result	
		#print buildcache._hash_title_and_category()

	else:
		#print json.dumps({"search_location":"/Search?hash="+buildcache._hash_title_and_category()},sort_keys=True, indent=4)
		print json.dumps({"access_results:": "api/Search?term="+title+"&category="+category})
		buildcache.build_cache()
		#json = cache.to_json()
		#lines = json.split('\n')
		#for line in lines:
		#	print line


GET()
